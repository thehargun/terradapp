{"ast":null,"code":"import jscrypto from 'jscrypto';\nimport secp256k1 from 'secp256k1';\nexport function verifyBytes(bytes, signBytesResult) {\n  var _a;\n\n  const publicKey = (_a = signBytesResult.public_key) === null || _a === void 0 ? void 0 : _a.toProto();\n\n  if (publicKey && 'key' in publicKey) {\n    return secp256k1.ecdsaVerify(signBytesResult.signature, Buffer.from(jscrypto.SHA256.hash(new jscrypto.Word32Array(bytes)).toString(), 'hex'), publicKey.key);\n  }\n\n  return false;\n}","map":{"version":3,"sources":["../../../src/@terra-money/wallet-provider/verifyBytes.ts"],"names":[],"mappings":"AACA,OAAO,QAAP,MAAqB,UAArB;AACA,OAAO,SAAP,MAAsB,WAAtB;AAEA,OAAM,SAAU,WAAV,CACJ,KADI,EAEJ,eAFI,EAEsC;;;AAE1C,QAAM,SAAS,GAAG,CAAA,EAAA,GAAA,eAAe,CAAC,UAAhB,MAA0B,IAA1B,IAA0B,EAAA,KAAA,KAAA,CAA1B,GAA0B,KAAA,CAA1B,GAA0B,EAAA,CAAE,OAAF,EAA5C;;AAEA,MAAI,SAAS,IAAI,SAAS,SAA1B,EAAqC;AACnC,WAAO,SAAS,CAAC,WAAV,CACL,eAAe,CAAC,SADX,EAEL,MAAM,CAAC,IAAP,CACE,QAAQ,CAAC,MAAT,CAAgB,IAAhB,CAAqB,IAAI,QAAQ,CAAC,WAAb,CAAyB,KAAzB,CAArB,EAAsD,QAAtD,EADF,EAEE,KAFF,CAFK,EAML,SAAS,CAAC,GANL,CAAP;AAQD;;AAED,SAAO,KAAP;AACD","sourcesContent":["import { SignBytesResult } from '@terra-money/use-wallet';\nimport jscrypto from 'jscrypto';\nimport secp256k1 from 'secp256k1';\n\nexport function verifyBytes(\n  bytes: Buffer,\n  signBytesResult: SignBytesResult['result'],\n): boolean {\n  const publicKey = signBytesResult.public_key?.toProto();\n\n  if (publicKey && 'key' in publicKey) {\n    return secp256k1.ecdsaVerify(\n      signBytesResult.signature,\n      Buffer.from(\n        jscrypto.SHA256.hash(new jscrypto.Word32Array(bytes)).toString(),\n        'hex',\n      ),\n      publicKey.key,\n    );\n  }\n\n  return false;\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}