"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyBytes = void 0;
const jscrypto_1 = __importDefault(require("jscrypto"));
const secp256k1_1 = __importDefault(require("secp256k1"));
function verifyBytes(bytes, signBytesResult) {
    var _a;
    const publicKey = (_a = signBytesResult.public_key) === null || _a === void 0 ? void 0 : _a.toProto();
    if (publicKey && 'key' in publicKey) {
        return secp256k1_1.default.ecdsaVerify(signBytesResult.signature, Buffer.from(jscrypto_1.default.SHA256.hash(new jscrypto_1.default.Word32Array(bytes)).toString(), 'hex'), publicKey.key);
    }
    return false;
}
exports.verifyBytes = verifyBytes;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5Qnl0ZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvQHRlcnJhLW1vbmV5L3dhbGxldC1wcm92aWRlci92ZXJpZnlCeXRlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSx3REFBZ0M7QUFDaEMsMERBQWtDO0FBRWxDLFNBQWdCLFdBQVcsQ0FDekIsS0FBYSxFQUNiLGVBQTBDOztJQUUxQyxNQUFNLFNBQVMsR0FBRyxNQUFBLGVBQWUsQ0FBQyxVQUFVLDBDQUFFLE9BQU8sRUFBRSxDQUFDO0lBRXhELElBQUksU0FBUyxJQUFJLEtBQUssSUFBSSxTQUFTLEVBQUU7UUFDbkMsT0FBTyxtQkFBUyxDQUFDLFdBQVcsQ0FDMUIsZUFBZSxDQUFDLFNBQVMsRUFDekIsTUFBTSxDQUFDLElBQUksQ0FDVCxrQkFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxrQkFBUSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUNoRSxLQUFLLENBQ04sRUFDRCxTQUFTLENBQUMsR0FBRyxDQUNkLENBQUM7S0FDSDtJQUVELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQWxCRCxrQ0FrQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaWduQnl0ZXNSZXN1bHQgfSBmcm9tICdAdGVycmEtbW9uZXkvdXNlLXdhbGxldCc7XG5pbXBvcnQganNjcnlwdG8gZnJvbSAnanNjcnlwdG8nO1xuaW1wb3J0IHNlY3AyNTZrMSBmcm9tICdzZWNwMjU2azEnO1xuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5Qnl0ZXMoXG4gIGJ5dGVzOiBCdWZmZXIsXG4gIHNpZ25CeXRlc1Jlc3VsdDogU2lnbkJ5dGVzUmVzdWx0WydyZXN1bHQnXSxcbik6IGJvb2xlYW4ge1xuICBjb25zdCBwdWJsaWNLZXkgPSBzaWduQnl0ZXNSZXN1bHQucHVibGljX2tleT8udG9Qcm90bygpO1xuXG4gIGlmIChwdWJsaWNLZXkgJiYgJ2tleScgaW4gcHVibGljS2V5KSB7XG4gICAgcmV0dXJuIHNlY3AyNTZrMS5lY2RzYVZlcmlmeShcbiAgICAgIHNpZ25CeXRlc1Jlc3VsdC5zaWduYXR1cmUsXG4gICAgICBCdWZmZXIuZnJvbShcbiAgICAgICAganNjcnlwdG8uU0hBMjU2Lmhhc2gobmV3IGpzY3J5cHRvLldvcmQzMkFycmF5KGJ5dGVzKSkudG9TdHJpbmcoKSxcbiAgICAgICAgJ2hleCcsXG4gICAgICApLFxuICAgICAgcHVibGljS2V5LmtleSxcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIl19