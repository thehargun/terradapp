import jscrypto from 'jscrypto';
import secp256k1 from 'secp256k1';
export function verifyBytes(bytes, signBytesResult) {
    var _a;
    const publicKey = (_a = signBytesResult.public_key) === null || _a === void 0 ? void 0 : _a.toProto();
    if (publicKey && 'key' in publicKey) {
        return secp256k1.ecdsaVerify(signBytesResult.signature, Buffer.from(jscrypto.SHA256.hash(new jscrypto.Word32Array(bytes)).toString(), 'hex'), publicKey.key);
    }
    return false;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5Qnl0ZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvQHRlcnJhLW1vbmV5L3dhbGxldC1wcm92aWRlci92ZXJpZnlCeXRlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLFFBQVEsTUFBTSxVQUFVLENBQUM7QUFDaEMsT0FBTyxTQUFTLE1BQU0sV0FBVyxDQUFDO0FBRWxDLE1BQU0sVUFBVSxXQUFXLENBQ3pCLEtBQWEsRUFDYixlQUEwQzs7SUFFMUMsTUFBTSxTQUFTLEdBQUcsTUFBQSxlQUFlLENBQUMsVUFBVSwwQ0FBRSxPQUFPLEVBQUUsQ0FBQztJQUV4RCxJQUFJLFNBQVMsSUFBSSxLQUFLLElBQUksU0FBUyxFQUFFO1FBQ25DLE9BQU8sU0FBUyxDQUFDLFdBQVcsQ0FDMUIsZUFBZSxDQUFDLFNBQVMsRUFDekIsTUFBTSxDQUFDLElBQUksQ0FDVCxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLFFBQVEsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsRUFDaEUsS0FBSyxDQUNOLEVBQ0QsU0FBUyxDQUFDLEdBQUcsQ0FDZCxDQUFDO0tBQ0g7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaWduQnl0ZXNSZXN1bHQgfSBmcm9tICdAdGVycmEtbW9uZXkvdXNlLXdhbGxldCc7XG5pbXBvcnQganNjcnlwdG8gZnJvbSAnanNjcnlwdG8nO1xuaW1wb3J0IHNlY3AyNTZrMSBmcm9tICdzZWNwMjU2azEnO1xuXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5Qnl0ZXMoXG4gIGJ5dGVzOiBCdWZmZXIsXG4gIHNpZ25CeXRlc1Jlc3VsdDogU2lnbkJ5dGVzUmVzdWx0WydyZXN1bHQnXSxcbik6IGJvb2xlYW4ge1xuICBjb25zdCBwdWJsaWNLZXkgPSBzaWduQnl0ZXNSZXN1bHQucHVibGljX2tleT8udG9Qcm90bygpO1xuXG4gIGlmIChwdWJsaWNLZXkgJiYgJ2tleScgaW4gcHVibGljS2V5KSB7XG4gICAgcmV0dXJuIHNlY3AyNTZrMS5lY2RzYVZlcmlmeShcbiAgICAgIHNpZ25CeXRlc1Jlc3VsdC5zaWduYXR1cmUsXG4gICAgICBCdWZmZXIuZnJvbShcbiAgICAgICAganNjcnlwdG8uU0hBMjU2Lmhhc2gobmV3IGpzY3J5cHRvLldvcmQzMkFycmF5KGJ5dGVzKSkudG9TdHJpbmcoKSxcbiAgICAgICAgJ2hleCcsXG4gICAgICApLFxuICAgICAgcHVibGljS2V5LmtleSxcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIl19